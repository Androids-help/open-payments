---
id: api
title: API
---

import { Mermaid } from './Mermaid'

Open Payments is a REST API with 5 resource definitions:

- [accounts](./accounts)
- [connections](./connections)
- [invoices](./invoices)
- [mandates](./mandates)
- [charges](./charges)

The URL of the **accounts** resource is [discovered](./discovery) by the client
and all other endpoints are then relative to that URL. As shown in the ERD below
the root resource is an **account**.

Accounts have 3 sub-resources, **invoices**, **mandates** and **connections**
and APIs are defined to both create and get invoices and mandates under the
account. 

Invoices also have a **connections** sub-resource.

It is not possible to create a new connection explicitly via the API, however
when a client queries the connections resource (under an account or invoice) a
new set of connection credentials is returned each time.

Mandates have a **charges** sub-resource which has a create API allowing clients
to create a new charge against the mandate. In most cases the charge will
reference an invoice on the client's system describing the details of the charge
that is being requested.

<Mermaid
  chart={`erDiagram
  INVOICE }o--|| ACCOUNT: "aggregates payments into"
  ACCOUNT-CONNECTION }o--|| ACCOUNT: "accepts payments into"
  MANDATE }o--|| ACCOUNT: "authorizes payments from"
  INVOICE-CONNECTION }o--|| INVOICE: "accepts payments against"
  CHARGE }o--|| MANDATE: "charged against"
`}
/>

## APIs

### Create

All resources are created using an HTTP `POST` request to the API endpoint,
however [connections](./connections) don't support the create operation.

A successful response to a create request has an HTTP `201 Created` response
code and a `Location` header containing the URL of the newly created resource.

The resource is also returned in the body of the response.

A newly created invoice resource will contain a connection sub-resource in the
API response however subsequent requests to get the resource will not. New
connection credentials can be generated by querying the connections
sub-resource.

### Get

Resources can be accessed using an HTTP `GET` request.

Sub-resources are accessed at URLs relative to the parent resource URL.

## Authorization

All APIs MAY be protected by the Open Payments server. The default mechanism for
accessing protected resources is to provide a bearer token in the authorization
header of the request.

If a client is unable to access a resource it can attempt to get an access token
using OAuth2 via the Open Payments server's authorization endpoint.

The URL of the resource that the client wishes to access MUST be used as the
requested scope in the OAuth2 authorization request.
